      SUBROUTINE TRANS6(B,T,IFLA1,IFLA2)
C**************************************************************
C
C****THIS ROUTINE BUILDS A 6x6 TRANSFORMATION MATRIX
C    BASED ON THE 3x3 DIRECTOR COSINE MATRIX
C
C**************************************************************
      IMPLICIT REAL*8(A-H,O-Z)
      CHARACTER*6 IFLA1,IFLA2
C
      DIMENSION B(3,*), T(6,*)
C
C     CASE 1 :  'STRAIN' 'G_TO_L'
C
      IF(IFLA1.EQ.'STRAIN'.AND.IFLA2.EQ.'G_TO_L') THEN
C
C     TQ
C
      T(1,1)=B(1,1)*B(1,1)
      T(1,2)=B(1,2)*B(1,2)
      T(1,4)=B(1,3)*B(1,3)
C
      T(2,1)=B(2,1)*B(2,1)
      T(2,2)=B(2,2)*B(2,2)
      T(2,4)=B(2,3)*B(2,3)
C
      T(4,1)=B(3,1)*B(3,1)
      T(4,2)=B(3,2)*B(3,2)
      T(4,4)=B(3,3)*B(3,3)
C
C  TR
C
      T(1,3)=B(1,1)*B(1,2)
      T(1,5)=B(1,3)*B(1,1)
      T(1,6)=B(1,2)*B(1,3)
C
      T(2,3)=B(2,1)*B(2,2)
      T(2,5)=B(2,3)*B(2,1)
      T(2,6)=B(2,2)*B(2,3)
C
      T(4,3)=B(3,1)*B(3,2)
      T(4,5)=B(3,3)*B(3,1)
      T(4,6)=B(3,2)*B(3,3)
C
C   TS
C
      T(3,1)=B(1,1)*B(2,1)*2.
      T(3,2)=B(1,2)*B(2,2)*2.
      T(3,4)=B(1,3)*B(2,3)*2.
C
      T(5,1)=B(3,1)*B(1,1)*2.
      T(5,2)=B(3,2)*B(1,2)*2.
      T(5,4)=B(3,3)*B(1,3)*2.
C
      T(6,1)=B(2,1)*B(3,1)*2.
      T(6,2)=B(2,2)*B(3,2)*2.
      T(6,4)=B(2,3)*B(3,3)*2.
C
C   TT
C
      T(3,3)=B(1,1)*B(2,2)+B(1,2)*B(2,1)
      T(3,5)=B(1,3)*B(2,1)+B(1,1)*B(2,3)
      T(3,6)=B(1,2)*B(2,3)+B(1,3)*B(2,2)
C
      T(5,3)=B(3,1)*B(1,2)+B(3,2)*B(1,1)
      T(5,5)=B(3,3)*B(1,1)+B(3,1)*B(1,3)
      T(5,6)=B(3,2)*B(1,3)+B(3,3)*B(1,2)
C
      T(6,3)=B(2,1)*B(3,2)+B(2,2)*B(3,1)
      T(6,5)=B(2,3)*B(3,1)+B(2,1)*B(3,3)
      T(6,6)=B(2,2)*B(3,3)+B(2,3)*B(3,2)
C
      ENDIF
C
C
C     CASE 2 :  'STRESS' 'G_TO_L'
C
      IF(IFLA1.EQ.'STRESS'.AND.IFLA2.EQ.'G_TO_L') THEN
C
C     TQ
C
      T(1,1)=B(1,1)*B(1,1)
      T(1,2)=B(1,2)*B(1,2)
      T(1,4)=B(1,3)*B(1,3)

      T(2,1)=B(2,1)*B(2,1)
      T(2,2)=B(2,2)*B(2,2)
      T(2,4)=B(2,3)*B(2,3)

      T(4,1)=B(3,1)*B(3,1)
      T(4,2)=B(3,2)*B(3,2)
      T(4,4)=B(3,3)*B(3,3)
C
C   0.5*TS
C
      T(3,1)=B(1,1)*B(2,1)
      T(3,2)=B(1,2)*B(2,2)
      T(3,4)=B(1,3)*B(2,3)
C
      T(5,1)=B(3,1)*B(1,1)
      T(5,2)=B(3,2)*B(1,2)
      T(5,4)=B(3,3)*B(1,3)
C
      T(6,1)=B(2,1)*B(3,1)
      T(6,2)=B(2,2)*B(3,2)
      T(6,4)=B(2,3)*B(3,3)
C
C  2.*TR
C
      T(1,3)=B(1,1)*B(1,2)*2.
      T(1,5)=B(1,3)*B(1,1)*2.
      T(1,6)=B(1,2)*B(1,3)*2.
C
      T(2,3)=B(2,1)*B(2,2)*2.
      T(2,5)=B(2,3)*B(2,1)*2.
      T(2,6)=B(2,2)*B(2,3)*2.
C
      T(4,3)=B(3,1)*B(3,2)*2.
      T(4,5)=B(3,3)*B(3,1)*2.
      T(4,6)=B(3,2)*B(3,3)*2.
C
C   TT
C
      T(3,3)=B(1,1)*B(2,2)+B(1,2)*B(2,1)
      T(3,5)=B(1,3)*B(2,1)+B(1,1)*B(2,3)
      T(3,6)=B(1,2)*B(2,3)+B(1,3)*B(2,2)
C
      T(5,3)=B(3,1)*B(1,2)+B(3,2)*B(1,1)
      T(5,5)=B(3,3)*B(1,1)+B(3,1)*B(1,3)
      T(5,6)=B(3,2)*B(1,3)+B(3,3)*B(1,2)
C
      T(6,3)=B(2,1)*B(3,2)+B(2,2)*B(3,1)
      T(6,5)=B(2,3)*B(3,1)+B(2,1)*B(3,3)
      T(6,6)=B(2,2)*B(3,3)+B(2,3)*B(3,2)
C
      ENDIF
C
C
C     CASE 3 :  'STRESS' 'L_TO_G'
C
      IF(IFLA1.EQ.'STRESS'.AND.IFLA2.EQ.'L_TO_G') THEN
C
C     TQ trans
C
      T(1,1)=B(1,1)*B(1,1)
      T(2,1)=B(1,2)*B(1,2)
      T(4,1)=B(1,3)*B(1,3)

      T(1,2)=B(2,1)*B(2,1)
      T(2,2)=B(2,2)*B(2,2)
      T(4,2)=B(2,3)*B(2,3)

      T(1,4)=B(3,1)*B(3,1)
      T(2,4)=B(3,2)*B(3,2)
      T(4,4)=B(3,3)*B(3,3)
C
C   TS  trans
C
      T(1,3)=B(1,1)*B(2,1)*2.
      T(2,3)=B(1,2)*B(2,2)*2.
      T(4,3)=B(1,3)*B(2,3)*2.
C
      T(1,5)=B(3,1)*B(1,1)*2.
      T(2,5)=B(3,2)*B(1,2)*2.
      T(4,5)=B(3,3)*B(1,3)*2.
C
      T(1,6)=B(2,1)*B(3,1)*2.
      T(2,6)=B(2,2)*B(3,2)*2.
      T(4,6)=B(2,3)*B(3,3)*2.
C
C  TR  trans
C
      T(3,1)=B(1,1)*B(1,2)
      T(5,1)=B(1,3)*B(1,1)
      T(6,1)=B(1,2)*B(1,3)
C
      T(3,2)=B(2,1)*B(2,2)
      T(5,2)=B(2,3)*B(2,1)
      T(6,2)=B(2,2)*B(2,3)
C
      T(3,4)=B(3,1)*B(3,2)
      T(5,4)=B(3,3)*B(3,1)
      T(6,4)=B(3,2)*B(3,3)
C
C   TT  trans
C
      T(3,3)=B(1,1)*B(2,2)+B(1,2)*B(2,1)
      T(5,3)=B(1,3)*B(2,1)+B(1,1)*B(2,3)
      T(6,3)=B(1,2)*B(2,3)+B(1,3)*B(2,2)
C
      T(3,5)=B(3,1)*B(1,2)+B(3,2)*B(1,1)
      T(5,5)=B(3,3)*B(1,1)+B(3,1)*B(1,3)
      T(6,5)=B(3,2)*B(1,3)+B(3,3)*B(1,2)
C
      T(3,6)=B(2,1)*B(3,2)+B(2,2)*B(3,1)
      T(5,6)=B(2,3)*B(3,1)+B(2,1)*B(3,3)
      T(6,6)=B(2,2)*B(3,3)+B(2,3)*B(3,2)
C
      ENDIF
C
C
C     CASE 4 :  'STRAIN' 'L_TO_G'
C
      IF(IFLA1.EQ.'STRAIN'.AND.IFLA2.EQ.'L_TO_G') THEN
C
C     TQ trans
C
      T(1,1)=B(1,1)*B(1,1)
      T(2,1)=B(1,2)*B(1,2)
      T(4,1)=B(1,3)*B(1,3)

      T(1,2)=B(2,1)*B(2,1)
      T(2,2)=B(2,2)*B(2,2)
      T(4,2)=B(2,3)*B(2,3)

      T(1,4)=B(3,1)*B(3,1)
      T(2,4)=B(3,2)*B(3,2)
      T(4,4)=B(3,3)*B(3,3)
C
C   0.5*TS  trans
C
      T(1,3)=B(1,1)*B(2,1)
      T(2,3)=B(1,2)*B(2,2)
      T(4,3)=B(1,3)*B(2,3)
C
      T(1,5)=B(3,1)*B(1,1)
      T(2,5)=B(3,2)*B(1,2)
      T(4,5)=B(3,3)*B(1,3)
C
      T(1,6)=B(2,1)*B(3,1)
      T(2,6)=B(2,2)*B(3,2)
      T(4,6)=B(2,3)*B(3,3)
C
C  2.*TR trans
C
      T(3,1)=B(1,1)*B(1,2)*2.
      T(5,1)=B(1,3)*B(1,1)*2.
      T(6,1)=B(1,2)*B(1,3)*2.
C
      T(3,2)=B(2,1)*B(2,2)*2.
      T(5,2)=B(2,3)*B(2,1)*2.
      T(6,2)=B(2,2)*B(2,3)*2.
C
      T(3,4)=B(3,1)*B(3,2)*2.
      T(5,4)=B(3,3)*B(3,1)*2.
      T(6,4)=B(3,2)*B(3,3)*2.
C
C   TT  trans
C
      T(3,3)=B(1,1)*B(2,2)+B(1,2)*B(2,1)
      T(5,3)=B(1,3)*B(2,1)+B(1,1)*B(2,3)
      T(6,3)=B(1,2)*B(2,3)+B(1,3)*B(2,2)
C
      T(3,5)=B(3,1)*B(1,2)+B(3,2)*B(1,1)
      T(5,5)=B(3,3)*B(1,1)+B(3,1)*B(1,3)
      T(6,5)=B(3,2)*B(1,3)+B(3,3)*B(1,2)
C
      T(3,6)=B(2,1)*B(3,2)+B(2,2)*B(3,1)
      T(5,6)=B(2,3)*B(3,1)+B(2,1)*B(3,3)
      T(6,6)=B(2,2)*B(3,3)+B(2,3)*B(3,2)
C
      ENDIF
C
      RETURN
      END
