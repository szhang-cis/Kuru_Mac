      SUBROUTINE PROPOVN(ITAPE,PROPS)
C***********************************************************************
C
C**** THIS ROUTINE READS THE MATERIAL PROPERTIES FOR THE ORTHOTROPIC,
C     VISCOPLASTIC & NON TEMPERATURE-DEPENDENT SOLID MODEL WITH DAMAGE
C     (ELEMENT NO. 30)
C
C**** OUTPUT (see pointe.f)
C
C     KPLA1: isotropic hardening
C     KPLA2: kinematic hardening
C     KPLA3: damage
C     KPLA4: porosity (Gurson model)
C     KPLA6: fatigue
C     KPLA7: strain-rate-dependent hardening models
C
C***********************************************************************
      IMPLICIT REAL*8(A-H,O-Z)
C
C**** COUPLING VARIABLES
C
      INCLUDE 'nuec_om.f'
C
C**** THERMAL VARIABLES
C
      INCLUDE 'prob_om.f'
      INCLUDE 'auxl_om.f'
      INCLUDE 'inte_om.f'
      INCLUDE 'inpo_om.f'
C
      DIMENSION PROPS(*)
C
C**** ESTABLISH SOME PARAMETERS
C
      PROPS(1)=1.0             ! orthotropic
      PROPS(2)=30.0            ! viscoplastic
      PROPS(3)=1.0             ! no temperature-dependent
      PROPS(59)=3.0            ! solidification
C
      PROPS(37)=0.0            ! non prescribed strains (see incstn.f)
      PROPS(19)=0.0
C
      PROPS(21)=0.0            ! no external damping
      PROPS(22)=0.0
C
      IF(NANIS.EQ.0)
     . CALL RUNEND('ERROR: ANISO. CARD MUST BE INPUT IN PROBLEM DATA')
      IANIS=1                  ! at least one material is orthotropic
C
      IF(NDIME.EQ.1)
     . CALL RUNEND('ERROR: 1D ANISOTROPY MODEL NOT IMPLEMENTED')
C
C**** READ & WRITE MATERIAL PROPERTIES
C
      NPRIN=0
C
C**** LOOK FOR 'DENSITY' CARD
C
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      IF(WORDS(1).EQ.'DENSI') THEN
       PROPS(12)=PARAM(1)
       WRITE(LURES,801) PROPS(12)
       WRITE(LURES,899)
      ELSE
       IF(KDYNA.EQ.1) THEN
        CALL RUNEND('PROPONN: DENSITY CARD NOT FOUND')
       ELSE
        PROPS(12)=0.0D0
        CALL RUNMEN('WARNING: ZERO DENSITY VALUE IS ASSUMED')
        GO TO 1
       ENDIF
      ENDIF
C
C**** LOOK FOR 'YOUNG_MODULI' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    1 IF(WORDS(1).EQ.'YOUNG') THEN
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'XX') THEN
        NPOI1=61
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        EX=PARAM(1)
        WRITE(LURES,803) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: COMPONENT XX CARD NOT FOUND')
       ENDIF
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'YY') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        EY=PARAM(1)
        WRITE(LURES,804) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: COMPONENT YY CARD NOT FOUND')
       ENDIF
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'ZZ') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        EZ=PARAM(1)
        WRITE(LURES,805) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: COMPONENT ZZ CARD NOT FOUND')
       ENDIF
      ELSE
       CALL RUNEND('PROPOVN: YOUNG_MODULI CARD NOT FOUND')
      ENDIF
C
C**** LOOK FOR 'POISSON_RATII' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      IF(WORDS(1).EQ.'POISS') THEN
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'XY') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        PXY=PARAM(1)
        WRITE(LURES,806) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: COMPONENT XY CARD NOT FOUND')
       ENDIF
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'XZ') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        PXZ=PARAM(1)
        WRITE(LURES,807) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: COMPONENT XZ CARD NOT FOUND')
       ENDIF
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'YZ') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        PYZ=PARAM(1)
        WRITE(LURES,808) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: COMPONENT YZ CARD NOT FOUND')
       ENDIF
      ELSE
       CALL RUNEND('PROPOVN: POISSON_RATII CARD NOT FOUND')
      ENDIF
C
C**** CHECK MATERIAL STABILITY CONDITIONS
C
      SC1=EZ-PYZ*PYZ*EY
      IF(SC1.LT.0.0D0)
     . CALL RUNMEN('WARNING: STABILITY CONDITION 1 IS NOT FULFILLED')
      SC2=EZ-PXZ*PXZ*EX
      IF(SC2.LT.0.0D0)
     . CALL RUNMEN('WARNING: STABILITY CONDITION 2 IS NOT FULFILLED')
      SC3=EY-PXY*PXY*EX
      IF(SC3.LT.0.0D0)
     . CALL RUNMEN('WARNING: STABILITY CONDITION 3 IS NOT FULFILLED')
C
C**** LOOK FOR 'SHEAR_MODULI' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      IF(WORDS(1).EQ.'SHEAR') THEN
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'XY') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        WRITE(LURES,809) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: COMPONENT XY CARD NOT FOUND')
       ENDIF
       IF(NDIME.EQ.3) THEN
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'XZ') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         WRITE(LURES,810) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COMPONENT XZ CARD NOT FOUND')
        ENDIF
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'COMPO'.AND.WORDS(2).EQ.'YZ') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         WRITE(LURES,811) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COMPONENT YZ CARD NOT FOUND')
        ENDIF
       ENDIF
      ELSE
       CALL RUNEND('PROPOVN: SHEAR_MODULI CARD NOT FOUND')
      ENDIF
C
C**** LOOK FOR 'REFERENCE_TEMPERATURE' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      NTEMP=0
      IF(WORDS(1).EQ.'REFER') THEN
       PROPS(11)=PARAM(1)
       WRITE(LURES,1804) PROPS(11)
      ELSE
       NTEMP=1
       GO TO 2
      ENDIF
C
C**** LOOK FOR 'THERMAL_DILATATION' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    2 IF(WORDS(1).EQ.'THERM')THEN
       IF(NTEMP.EQ.1)
     .  CALL RUNEND('PROPOVN: REFERENCE TEMPERATURE CARD NOT FOUND')
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI1)=PARAM(1)
       WRITE(LURES,1806) PROPS(NPOI1)
       WRITE(LURES,899)
      ELSE
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI2)=0.0
       IF(NTEMP.EQ.0)
     .  CALL RUNMEN('WARNING: THERMAL_DILAT. CARD NOT FOUND')
       GO TO 3
      ENDIF
C
C**** LOOK FOR 'HD_FUNCTION' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    3 IF((WORDS(1).EQ.'HD_FU').OR.(WORDS(1).EQ.'TH_HD')) THEN
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI1)=PARAM(1)
       WRITE(LURES,1807) PROPS(NPOI1)
       WRITE(LURES,899)
      ELSE
       CALL RUNEND('PROPOVN: HARDEN. FUNCTION CARD NOT FOUND')
      ENDIF
C
C**** LOOK FOR 'FLOW_PARAMETERS' CARD (PARAMETERS OF VISCOUS LAW)
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      IF(WORDS(1).EQ.'FLOW_') THEN
       IF(WORDS(2).EQ.'MODEL') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)      ! ivifl
        IVIFL=INT(PARAM(1))
       ELSE                        ! default: flow model=1
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=1.0
        IVIFL=1
       ENDIF
      ELSE
       CALL RUNEND('PROPOVN: FLOW_PARAMETERS CARD NOT FOUND')
      ENDIF
C
C**** LOOK FOR 'VISCOSITY' CARD
C
      IF(IVIFL.EQ.1.OR.IVIFL.EQ.2.OR.IVIFL.EQ.3.OR.IVIFL.EQ.4) THEN
       NPRIN=0
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'VISCO') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        WRITE(LURES,1808) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: VISCOSITY CARD NOT FOUND')
       ENDIF
C
C**** LOOK FOR 'EXPONENT' CARD (EXPONENT OF VISCOUS LAW)
C
       NPRIN=0
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'EXPON') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        WRITE(LURES,1809) PROPS(NPOI1)
        WRITE(LURES,899)
        IF(PROPS(NPOI1).LE.0.0D0)
     .   CALL RUNEND('PROPOVN: EXPONENT LE 0.0')
       ELSE
        CALL RUNEND('PROPOVN: EXPONENT CARD NOT FOUND')
       ENDIF
      ENDIF           ! ivifl.eq.1.or. ... ivifl.eq.4
C
C**** LOOK FOR DANILO'S COEFFICIENTS (A, B & C)
C
      IF(IVIFL.EQ.7) THEN
C
C**** COEFFICIENT A
C
       NPRIN=0
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'A_COE') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        WRITE(LURES,1811) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: A_COEFFICIENT CARD NOT FOUND')
       ENDIF
C
C**** COEFFICIENT B
C
       NPRIN=0
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'B_COE') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        WRITE(LURES,1812) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: B_COEFFICIENT CARD NOT FOUND')
       ENDIF
C
C**** COEFFICIENT C
C
       NPRIN=0
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'C_COE') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        WRITE(LURES,1813) PROPS(NPOI1)
        WRITE(LURES,899)
       ELSE
        CALL RUNEND('PROPOVN: C_COEFFICIENT CARD NOT FOUND')
       ENDIF
      ENDIF           ! ivifl.eq.7
C
C**** LOOK FOR 'ISOTROPIC_HARDENING' CARD
C
      NPRIN=0
      ISOTT=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      IF(WORDS(1).EQ.'ISOTR') THEN
       KAUXX=1
       IF(KAUXX.GT.KPLA1) KPLA1=1
       IF(WORDS(2).EQ.'MODEL') THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        IIAUX=INT(PARAM(1))
        ISOTT=IIAUX
        IF(IIAUX.LE.0.OR.IIAUX.GT.13)
     .   CALL RUNEND('ERROR: WRONG NUMBER OF MODEL FOR ISOT. HARDENING')
        IF(IIAUX.EQ.10.OR.IIAUX.EQ.11) THEN
         IF(KDYNA.EQ.0)
     .    CALL RUNMEN('WARNING: ISOT. HARD. MODEL=10 & STATIC ANALYSIS')
         KAUXX=1
         IF(KAUXX.GT.KPLA7) KPLA7=1
        ENDIF
C
C**** LOOK FOR 'HD_COEFFICIENT' CARD (HARDENING COEFFICIENT)
C
        IF(IIAUX.EQ.1.OR.IIAUX.EQ.2.OR.IIAUX.EQ.4.OR.IIAUX.EQ.5.OR.
     .     IIAUX.EQ.8.OR.IIAUX.EQ.10.OR.IIAUX.EQ.11.OR.IIAUX.EQ.12.OR.
     .     IIAUX.EQ.13) THEN
         NPRIN=0
         CALL LISTEN('PROPOVN',NPRIN,ITAPE)
         IF((WORDS(1).EQ.'HD_MO').OR.(WORDS(1).EQ.'HD_CO')) THEN
          NPOI1=NPOI2+1
          NPOI2=NPOI1
          PROPS(NPOI1)=PARAM(1)
          WRITE(LURES,1810) PROPS(NPOI1)
          WRITE(LURES,899)
         ELSE
          CALL RUNEND('ERROR: HARDEN. COEFF. CARD NOT FOUND')
         ENDIF
        ENDIF
C
C**** LOOK FOR 'B_COEFFICIENT' CARD (B COEFFICIENT)
C
        IF(IIAUX.EQ.3.OR.IIAUX.EQ.6.OR.IIAUX.EQ.7.OR.IIAUX.EQ.8.OR.
     .     IIAUX.EQ.10.OR.IIAUX.EQ.11.OR.IIAUX.EQ.12.OR.
     .     IIAUX.EQ.13) THEN
         NPRIN=0
         CALL LISTEN('PROPOVN',NPRIN,ITAPE)
         IF(WORDS(1).EQ.'B_COE')THEN
          NPOI1=NPOI2+1
          NPOI2=NPOI1
          PROPS(NPOI1)=PARAM(1)
          WRITE(LURES,1811) PROPS(NPOI1)
          WRITE(LURES,899)
         ELSE
          CALL RUNEND('ERROR: B COEFFICIENT. CARD NOT FOUND')
         ENDIF
C
C**** LOOK FOR 'Q_COEFFICIENT' CARD (Q COEFFICIENT)
C
         NPRIN=0
         CALL LISTEN('PROPOVN',NPRIN,ITAPE)
         IF(WORDS(1).EQ.'Q_COE')THEN
          NPOI1=NPOI2+1
          NPOI2=NPOI1
          PROPS(NPOI1)=PARAM(1)
          WRITE(LURES,812) PROPS(NPOI1)
          WRITE(LURES,899)
         ELSE
          CALL RUNEND('ERROR: Q COEFFICIENT CARD NOT FOUND')
         ENDIF
        ENDIF
C
C**** LOOK FOR 'HD_COEFFICIENT' CARD (Ep & T DEP. HARDENING COEFFICIENT)
C
        IF(IIAUX.EQ.9) THEN
         NPRIN=0
         CALL LISTEN('PROPOVN',NPRIN,ITAPE)
         IF((WORDS(1).EQ.'HD_MO').OR.(WORDS(1).EQ.'HD_CO'))THEN
          NPOI1=NPOI2+1
          NPOI2=NPOI1
          PROPS(NPOI1)=PARAM(1)
          NLINE=INT(PARAM(1))
          IF(NLINE.GT.20)
     .     CALL RUNEND('ERROR: WRONG NUMBER OF POINTS IN HA. CO. FUNC.')
          NPRIN=1
          DO LINEA=1,NLINE
           CALL LISTEN('PROPOVN',NPRIN,ITAPE)
           DO I=1,2
            NPOI2=NPOI2+1
            PROPS(NPOI2)=PARAM(I)
           ENDDO
          ENDDO
          WRITE(LURES,813)
          DO IPROP=NPOI1+1,NPOI2,2
           WRITE(LURES,802) PROPS(IPROP),PROPS(IPROP+1)
          ENDDO
          WRITE(LURES,899)
         ELSE
          CALL RUNEND('ERROR: HARDEN. COEFF. CARD NOT FOUND')
         ENDIF
        ENDIF
       ELSE
        CALL RUNEND('ERROR: NO MODEL FOR ISOTROPIC HARDENING')
       ENDIF
      ELSE
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI2)=0.0
       GO TO 4
      ENDIF
C
C**** LOOK FOR 'KINEMATIC_HARDENING' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    4 IF(WORDS(1).EQ.'KINEM')THEN
       KAUXX=1
       IF(KAUXX.GT.KPLA2) KPLA2=1
       IF(WORDS(2).EQ.'MODEL')THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)
        IIAUX=INT(PARAM(1))
        IF(IIAUX.LE.0.OR.IIAUX.GT.4)
     .   CALL RUNEND('ERROR: WRONG NUMBER OF MODEL FOR ISOT. HARDENING')
C
C**** LOOK FOR 'HD_COEFFICIENT' CARD (HARDENING COEFFICIENT)
C
        IF(IIAUX.EQ.1.OR.IIAUX.EQ.2) THEN
         NPRIN=0
         CALL LISTEN('PROPOVN',NPRIN,ITAPE)
         IF((WORDS(1).EQ.'HD_MO').OR.(WORDS(1).EQ.'HD_CO'))THEN
          NPOI1=NPOI2+1
          NPOI2=NPOI1
          PROPS(NPOI1)=PARAM(1)
          WRITE(LURES,1810) PROPS(NPOI1)
          WRITE(LURES,899)
         ELSE
          CALL RUNEND('ERROR: HARDEN. COEFF. CARD NOT FOUND')
         ENDIF
        ENDIF
C
C**** LOOK FOR 'B_COEFFICIENT' CARD (B COEFFICIENT)
C
        IF(IIAUX.EQ.3.OR.IIAUX.EQ.4) THEN
         NPRIN=0
         CALL LISTEN('PROPOVN',NPRIN,ITAPE)
         IF(WORDS(1).EQ.'B_COE')THEN
          NPOI1=NPOI2+1
          NPOI2=NPOI1
          PROPS(NPOI1)=PARAM(1)
          WRITE(LURES,1811) PROPS(NPOI1)
          WRITE(LURES,899)
         ELSE
          CALL RUNEND('ERROR: B COEFFICIENT. CARD NOT FOUND')
         ENDIF
C
C**** LOOK FOR 'Q_COEFFICIENT' CARD (Q COEFFICIENT)
C
         NPRIN=0
         CALL LISTEN('PROPOVN',NPRIN,ITAPE)
         IF(WORDS(1).EQ.'Q_COE')THEN
          NPOI1=NPOI2+1
          NPOI2=NPOI1
          PROPS(NPOI1)=PARAM(1)
          WRITE(LURES,812) PROPS(NPOI1)
          WRITE(LURES,899)
         ELSE
          CALL RUNEND('ERROR: Q COEFFICIENT CARD NOT FOUND')
         ENDIF
        ENDIF
       ELSE
        CALL RUNEND('ERROR: NO MODEL FOR ISOTROPIC HARDENING')
       ENDIF
      ELSE
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI2)=0.0
       GO TO 5
      ENDIF
C
C**** LOOK FOR 'YIELD_FUNCTION' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    5 IF(WORDS(1).EQ.'YIELD') THEN
       IAUXX=0
       IF(WORDS(2).EQ.'VON_M') THEN
        IAUXX=1
        PROPS(36)=32.0
        NCRIT=32
        IF(WORDS(3).EQ.'VERSI') THEN
         PROPS(35)=PARAM(1)
         IIAUX=INT(PROPS(35))
         IF(IIAUX.LE.0.OR.IIAUX.GT.4)
     .    CALL RUNEND('ERROR IN VERSION OF VON MISES YIELD CRIT.')
         IF(IIAUX.EQ.4.AND.NPRE3.EQ.0) INITP=1  ! ic index for int. var.
        ELSE
         PROPS(35)=1.0          ! default value for version of Von Mises
        ENDIF
       ENDIF
       IF(WORDS(2).EQ.'GURSO') THEN
        KAUXX=1
        IF(KAUXX.GT.KPLA4) KPLA4=1
        IAUXX=1
        PROPS(36)=41.0
        NCRIT=41
        IF(WORDS(3).EQ.'VERSI') THEN
         PROPS(35)=PARAM(1)
         IIAUX=INT(PROPS(35))
         IF(IIAUX.LE.0.OR.IIAUX.GT.4)
     .    CALL RUNEND('ERROR IN VERSION OF GURSON YIELD CRIT.')
        ELSE
         PROPS(35)=1.0          ! default value for version of Gurson
        ENDIF
       ENDIF
       IF(IAUXX.EQ.0)
     .  CALL RUNEND('PROPOVN: WRONG YIELD FUNCTION         ')
      ELSE
       CALL RUNEND('PROPOVN: YIELD FUNCTION CARD NOT FOUND')
      ENDIF
C
C**** LOOK FOR 'FLOW_POTENTIAL' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      IF(WORDS(1).EQ.'FLOW_') THEN
       IAUXX=0
       IF(WORDS(2).EQ.'VON_M') THEN
        IAUXX=1
        PROPS(52)=32.0
        NCRIP=32
        PROPS(56)=1.0D0         ! assumption
        KFLUJ=1
        IF(WORDS(3).EQ.'VERSI') THEN
         PROPS(51)=PARAM(1)
         IIAUX=INT(PROPS(51))
         IF(IIAUX.LE.0.OR.IIAUX.GT.4)
     .    CALL RUNEND('ERROR IN VERSION OF VON MISES FLOW POT.')
        ELSE
         PROPS(51)=1.0          ! default value for version of Von Mises
        ENDIF
       ENDIF
       IF(WORDS(2).EQ.'GURSO') THEN
        KAUXX=1
        IF(KAUXX.GT.KPLA4) KPLA4=1
        IAUXX=1
        PROPS(52)=41.0
        NCRIP=41
        IF(WORDS(3).EQ.'VERSI') THEN
         PROPS(51)=PARAM(1)
         IIAUX=INT(PROPS(51))
         IF(IIAUX.LE.0.OR.IIAUX.GT.4)
     .    CALL RUNEND('ERROR IN VERSION OF GURSON FLOW POT.')
        ELSE
         PROPS(51)=1.0          ! default value for version of Gurson
        ENDIF
       ENDIF
       IF(IAUXX.EQ.0)
     .  CALL RUNEND('PROPOVN: WRONG FLOW POTENTIAL FUNCTION         ')
      ELSE
       CALL RUNEND('PROPOVN: FLOW_POTENTIAL CARD NOT FOUND')
      ENDIF
C
      IF(NCRIT.EQ.NCRIP) THEN
       IF(KSYMM.EQ.0)
     .  CALL RUNMEN('WARNING: ASSOCIATE PLAST. & NON SYMMETRIC SOLVER')
      ELSE
       IF(KSYMM.EQ.1)
     .  CALL RUNMEN('WARNING: NON ASSOCIATE PLAST. & SYMMETRIC SOLVER')
      ENDIF
C
      IF(NCRIT.EQ.41.OR.NCRIP.EQ.41) THEN         ! Gurson
C
C**** LOOK FOR 'POROSITY' CARD
C
       NPRIN=0
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       IF(WORDS(1).EQ.'POROS')THEN
        IF(WORDS(2).EQ.'MODEL')THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         IIAUX=INT(PARAM(1))
         IF(IIAUX.LE.0.OR.IIAUX.GT.4)
     .    CALL RUNEND('ERROR: WRONG NUMBER OF MODEL FOR POROSITY')
         IF(ISOTT.EQ.3)
     .    CALL RUNMEN('WARNING: ISOT. MODEL 3 WITH POROSITY')
C
C**** LOOK FOR 'POROSITY_PARAMETER' CARD
C
         IF(IIAUX.EQ.1.OR.IIAUX.EQ.2.OR.IIAUX.EQ.3.OR.IIAUX.EQ.4) THEN
          IF(IIAUX.EQ.1.OR.IIAUX.EQ.3) THEN
           IF(KSYMM.EQ.1)
     .      CALL RUNMEN('WARNING: NON ASSOCIATE PLAST. & SYM. SOLVER')
          ENDIF
          NPRIN=0
          CALL LISTEN('PROPOVN',NPRIN,ITAPE)
          IF(WORDS(1).EQ.'POROS') THEN
           NPOI1=NPOI2+1
           NPOI2=NPOI1
           PROPS(NPOI1)=PARAM(1)
           WRITE(LURES,814) PROPS(NPOI1)
           WRITE(LURES,899)
          ELSE
           CALL RUNEND('PROPOVN: POROSITY_PARAMETER CARD NOT FOUND')
          ENDIF
         ENDIF
C
C**** LOOK FOR 'Q1_PARAMETER' CARD
C
         IF(IIAUX.EQ.4) THEN
          NPRIN=0
          CALL LISTEN('PROPOVN',NPRIN,ITAPE)
          IF(WORDS(1).EQ.'Q1_PA') THEN
           NPOI1=NPOI2+1
           NPOI2=NPOI1
           PROPS(NPOI1)=PARAM(1)
           WRITE(LURES,815) PROPS(NPOI1)
           WRITE(LURES,899)
          ELSE
           CALL RUNEND('PROPOVN: Q1_PARAMETER CARD NOT FOUND')
          ENDIF
         ENDIF
C
C**** LOOK FOR 'Q2_PARAMETER' CARD
C
         IF(IIAUX.EQ.4) THEN
          NPRIN=0
          CALL LISTEN('PROPOVN',NPRIN,ITAPE)
          IF(WORDS(1).EQ.'Q2_PA') THEN
           NPOI1=NPOI2+1
           NPOI2=NPOI1
           PROPS(NPOI1)=PARAM(1)
           WRITE(LURES,816) PROPS(NPOI1)
           WRITE(LURES,899)
          ELSE
           CALL RUNEND('PROPOVN: Q2_PARAMETER CARD NOT FOUND')
          ENDIF
         ENDIF
        ELSE
         CALL RUNEND('ERROR: NO MODEL FOR POROSITY')
        ENDIF
       ELSE
        CALL RUNEND('ERROR: POROSITY CARD NOT FOUND')
       ENDIF
      ENDIF                            ! ncrit.eq.41.or.ncrip.eq.41
C
C**** LOOK FOR 'LS_PHASE_CHANGE' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
      IF(WORDS(1).EQ.'LS_PH') THEN
       CALL LISTEN('PROPOVN',NPRIN,ITAPE)
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI2)=PARAM(1)            ! solidus
       NPOI2=NPOI2+1
       PROPS(NPOI2)=PARAM(2)            ! liquidus
      ELSE
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI2)=10.0E+10
       NPOI2=NPOI2+1
       PROPS(NPOI2)=10.0E+10
       GO TO 6
      ENDIF
C
C**** LOOK FOR 'DAMAGE_PARAMETERS' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    6 IF(WORDS(1).EQ.'DAMAG')THEN
       KAUXX=1
       IF(KAUXX.GT.KPLA3) KPLA3=1
       IF(WORDS(2).EQ.'MODEL')THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=PARAM(1)      ! idamg
        IDAMG=INT(PROPS(NPOI1))
        IF(IDAMG.NE.1.AND.IDAMG.NE.2.AND.IDAMG.NE.3.AND.IDAMG.NE.4.AND.
     .     IDAMG.NE.5.AND.IDAMG.NE.6.AND.IDAMG.NE.21)
     .   CALL RUNEND('PROPOVN: WRONG DAMAGE MODEL')
       ELSE                        ! default: damage model=1
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=1.0           ! idamg
        IDAMG=1
       ENDIF
C
       IF(IDAMG.EQ.1.OR.IDAMG.EQ.2) THEN
        call runmen('WARNING: plastic & viscopl.  models are different')
C
C**** LOOK FOR 'DAMAGE_PARAMETER_A' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'DAMAG') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,820) IDAMG
         WRITE(LURES,821) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COEFFICIENT DAMAGE_P_A CARD NOT FOUND')
        ENDIF
       ENDIF                  ! idamg.eq.1.or.idamg.eq.2
C
       IF(IDAMG.EQ.3) THEN

        call runend('ERROR: idamg=3 not implemented yet in propipn.f')

C
C**** LOOK FOR 'COEFFICIENT_B9' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'COEB9') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NLINE=INT(PARAM(1))
         IF(NLINE.GT.20)
     .    CALL RUNEND('ERROR: WRONG NUMBER OF POINTS IN COEF. B9')
         NPRIN=1
         DO LINEA=1,NLINE
          CALL LISTEN('PROPOVN',NPRIN,ITAPE)
          DO I=1,2
           NPOI2=NPOI2+1
           PROPS(NPOI2)=PARAM(I)
          ENDDO
         ENDDO
c        WRITE(LURES,839)
         DO IPROP=NPOI1+1,NPOI2,2
          WRITE(LURES,804) PROPS(IPROP),PROPS(IPROP+1)
         ENDDO
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COEFFICIENT B9 CARD NOT FOUND')
        ENDIF
       ENDIF                  ! idamg.eq.3
C
       IF(IDAMG.EQ.4.OR.IDAMG.EQ.5) THEN
C
C**** LOOK FOR 'EPSILON_D_PARAMETER' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'EPSIL') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,820) IDAMG
         WRITE(LURES,822) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COEFFICIENT EPSILON_D CARD NOT FOUND')
        ENDIF
C
C**** LOOK FOR 'EPSILON_R_PARAMETER' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'EPSIL') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,823) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COEFFICIENT EPSILON_R CARD NOT FOUND')
        ENDIF
C
C**** LOOK FOR 'CRITICAL_DAMAGE_PARAMETER' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'CRITI') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,824) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: CRITICAL_DAMAGE CARD NOT FOUND')
        ENDIF
C
C**** LOOK FOR 'FINAL_DAMAGE_PARAMETER' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'FINAL') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(2)
         NPRIN=1
         WRITE(LURES,825) PROPS(NPOI1-1),PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=1.0D0   ! final damage (theoretical value)
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=0.0D0   ! smoothing exponent ("theoretical value")
         CALL RUNMEN('WARNING: FINAL_DAMAGE_VALUE SET TO 1.0')
         GO TO 7
        ENDIF
       ENDIF                  ! idamg.eq.4.or.idamg.eq.5
C
       IF(IDAMG.EQ.6) THEN
C
C**** LOOK FOR 'S_PARAMETER' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'S_PAR') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,820) IDAMG
         WRITE(LURES,822) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COEFFICIENT S_PARAMETER CARD NOT FOUND')
        ENDIF
C
C**** LOOK FOR 'S_EXPONENT' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'S_EXP') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,829) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: COEFFICIENT S_EXPONENT CARD NOT FOUND')
        ENDIF
C
C**** LOOK FOR 'B_EXPONENT' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'B_EXP') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,830) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: CRITICAL_DAMAGE CARD NOT FOUND')
        ENDIF
C
C**** LOOK FOR 'A_PARAMETERS' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'A_PAR') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(2)
         NPRIN=1
         WRITE(LURES,831) PROPS(NPOI1-1),PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: A_PARAMETERS CARD NOT FOUND')
        ENDIF
C
C**** LOOK FOR 'FINAL_DAMAGE_PARAMETER' CARD
C
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'FINAL') THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=PARAM(1)
         NPRIN=1
         WRITE(LURES,832) PROPS(NPOI1)
         WRITE(LURES,899)
        ELSE
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI1)=1.0D0   ! final damage (theoretical value)
         CALL RUNMEN('WARNING: FINAL_DAMAGE_VALUE SET TO 1.0')
         GO TO 7
        ENDIF
       ENDIF                  ! idamg.eq.6
C
       IF(IDAMG.EQ.21) THEN
        NPRIN=0
        CALL LISTEN('PROPOVN',NPRIN,ITAPE)
        IF(WORDS(1).EQ.'GAMMA')THEN
         NPOI1=NPOI2+1
         NPOI2=NPOI1
         PROPS(NPOI2)=PARAM(1)     ! gamma-
         NPOI2=NPOI2+1
         PROPS(NPOI2)=PARAM(2)     ! gamma+
         WRITE(LURES,820) IDAMG
         WRITE(LURES,826) PROPS(NPOI2-1)
         WRITE(LURES,827) PROPS(NPOI2)
         WRITE(LURES,899)
        ELSE
         CALL RUNEND('PROPOVN: GAMMA PARAMETERS NOT FOUND')
        ENDIF
       ENDIF
      ELSE
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI1)=0.0            ! idamg
       GO TO 7
      ENDIF
C
C**** LOOK FOR FREE ENERGY MODEL
C
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    7 IF(WORDS(1).EQ.'FREE_') THEN
       NPOI1=NPOI2+1
       NPOI2=NPOI1
       PROPS(NPOI1)=PARAM(1)       ! ifren
       IFREN=INT(PROPS(NPOI1))
       IF(LARGE.EQ.0) THEN
        IF(IFREN.LE.0.OR.IFREN.GT.3)
     .   CALL RUNEND('ERROR: WRONG FREE ENERGY MODEL')
       ELSE
        IF(IFREN.LE.0.OR.IFREN.GT.10)
     .   CALL RUNEND('ERROR: WRONG FREE ENERGY MODEL')
       ENDIF
       WRITE(LURES,817) IFREN
       WRITE(LURES,899)
      ELSE                         ! defaults
       IF(LARGE.EQ.0) THEN
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=3.0           ! ifren
        IFREN=3
       ELSE
        NPOI1=NPOI2+1
        NPOI2=NPOI1
        PROPS(NPOI1)=2.0           ! ifren
        IFREN=2
       ENDIF
       WRITE(LURES,817) IFREN
       WRITE(LURES,899)
       GO TO 8
      ENDIF
C
C**** FATIGUE MODEL
C
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    8 IF(WORDS(1).EQ.'FATIG') THEN
       IFATI=1                             ! fatigue material
       KAUXX=1
       IF(KAUXX.GT.KPLA6) KPLA6=1
C
       IF(WORDS(2).EQ.'MODEL') THEN
        IFATM=INT(PARAM(1))                ! fatigue model
C
        IF(IFATM.EQ.1) THEN
         CALL PROPFA1(ITAPE,PROPS)
        ENDIF
C
        IF(IFATM.GE.2) THEN
         CALL RUNEND('PROPOVN: IFATM GT 2')
        ENDIF
       ELSE
        CALL RUNEND('ERROR: FATIGUE_MODEL CARD NOT FOUND')
       ENDIF
      ELSE
       GO TO 9
      ENDIF
C
C**** LOOK FOR 'END_MATERIAL' CARD
C
      NPRIN=0
      CALL LISTEN('PROPOVN',NPRIN,ITAPE)
    9 IF(WORDS(1).NE.'END_M')
     . CALL RUNEND('PROPOVN: END_MATERIAL CARD NOT FOUND   ')
      WRITE(LURES,899)
C
C**** CONTROLS DIMENSION OF PROPS
C
      IF(NPOI2.GT.NPROP) THEN
       WRITE(LURES,900) NPROP,NPOI2
       CALL RUNEND('PROPOVN: TOO MANY PROPERTIES TO READ')
      ENDIF
C
      RETURN
  801 FORMAT(/,'  CONSTANT DENSITY VALUE=',E15.6,/)
  802 FORMAT(E15.6,10X,E15.6)
  803 FORMAT(/,'  YOUNG MODULUS - COMPONENT XX =',E15.6,/)
  804 FORMAT(/,'  YOUNG MODULUS - COMPONENT YY =',E15.6,/)
  805 FORMAT(/,'  YOUNG MODULUS - COMPONENT ZZ =',E15.6,/)
  806 FORMAT(/,'  POISSON RATIO - COMPONENT XY =',E15.6,/)
  807 FORMAT(/,'  POISSON RATIO - COMPONENT XZ =',E15.6,/)
  808 FORMAT(/,'  POISSON RATIO - COMPONENT YZ =',E15.6,/)
  809 FORMAT(/,'  SHEAR MODULUS - COMPONENT XY =',E15.6,/)
  810 FORMAT(/,'  SHEAR MODULUS - COMPONENT XZ =',E15.6,/)
  811 FORMAT(/,'  SHEAR MODULUS - COMPONENT YZ =',E15.6,/)
 1804 FORMAT(/,'  REFERENCE TEMPERATURE =',E15.6,/)
 1806 FORMAT(/,'  THERMAL DILATATION    =',E15.6,/)
 1807 FORMAT(/,'  HARDENING FUNCTION    =',E15.6,/)
 1808 FORMAT(/,'  VISCOSITY             =',E15.6,/)
 1809 FORMAT(/,'  EXPONENT              =',E15.6,/)
 1810 FORMAT(/,'  HARDENING COEFFICIENT =',E15.6,/)
 1811 FORMAT(/,'  A COEFFICIENT         =',E15.6,/)
 1812 FORMAT(/,'  B COEFFICIENT         =',E15.6,/)
 1813 FORMAT(/,'  CUT-OFF VISCOSITY     =',E15.6,/)
  812 FORMAT(/,'  Q COEFFICIENT         =',E15.6,/)
  813 FORMAT(/,'  HARDENING COEF.   Vs.     EFF. PL. DEF.',/)
  814 FORMAT(/,'  POROSITY PARAMETER    =',E15.6,/)
  815 FORMAT(/,'  Q1 PARAMATER          =',E15.6,/)
  816 FORMAT(/,'  Q2 PARAMATER          =',E15.6,/)
  817 FORMAT(/,3X,'FREE ENERGY MODEL=',I5,/)
  820 FORMAT(/,3X,'DAMAGE PARAMETERS FOR MODEL=',I5,/)
  821 FORMAT(/,'  DAMAGE PARAMETER A    =',E15.6,/)
  822 FORMAT(/,'  EPSILON_D PARAMETER   =',E15.6,/)
  823 FORMAT(/,'  EPSILON_R PARAMETER   =',E15.6,/)
  824 FORMAT(/,'  CRITICAL DAMAGE       =',E15.6,/)
  825 FORMAT(/,'  FINAL DAMAGE          =',E15.6,/,
     .       /,'  SMOOTHING EXPONENT    =',E15.6,/)
  826 FORMAT(/,'  COMPRESSION GAMMA PAR.=',E15.6,/)
  827 FORMAT(/,'  TENSION GAMMA PARAM.  =',E15.6,/)
  828 FORMAT(/,'  S PARAMETER           =',E15.6,/)
  829 FORMAT(/,'  S EXPONENT            =',E15.6,/)
  830 FORMAT(/,'  B EXPONENT            =',E15.6,/)
  831 FORMAT(/,'  A PARAMETERS          =',E15.6,2X,E15.6,/)
  832 FORMAT(/,'  FINAL DAMAGE          =',E15.6,/)
  899 FORMAT(/)
  900 FORMAT(//,'TOO MANY MATERIAL PROPERTIES TO READ:',/,
     .      20X,'NPROP =',I5,5X,'NUMBE =',I5,/)
      END
